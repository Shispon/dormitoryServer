databaseChangeLog:
  - changeSet:
      id: create-notifications-table
      author: Shispon
      preConditions:
        - onFail: MARK_RAN
        - not:
            tableExists:
              tableName: notifications
              schemaName: diplom
      changes:
        - sql:
            sql:
                CREATE TABLE diplom.notifications (
                id int primary key generated by default as identity,
                resident_id INT NOT NULL, 
                parent_id INT,            
                template_id INT NOT NULL, 
                date_sent TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, 
                response TEXT,             
                date_response TIMESTAMP
                );
            dbms: postgresql
        - sql:
              sql:
                ALTER TABLE diplom.notifications
                ADD CONSTRAINT fk_resident FOREIGN KEY (resident_id) REFERENCES diplom.residents(id);
                
                ALTER TABLE diplom.notifications
                ADD CONSTRAINT fk_parent FOREIGN KEY (parent_id) REFERENCES diplom.parents(id);
                
                ALTER TABLE diplom.notifications
                ADD CONSTRAINT fk_template FOREIGN KEY (template_id) REFERENCES diplom.message_templates(id);
              dbms: postgresql