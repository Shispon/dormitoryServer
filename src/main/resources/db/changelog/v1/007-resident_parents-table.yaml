  databaseChangeLog:
    - changeSet:
        id: create-resident_parents-table
        author: Shispon
        preConditions:
          - onFail: MARK_RAN
          - not:
              tableExists:
                tableName: resident_parents
                schemaName: diplom
        changes:
          - sql:
              sql:
                CREATE TABLE diplom.resident_parents (
                id int primary key generated by default as identity,
                resident_id INT NOT NULL,
                parent_id INT NOT NULL
                );
              dbms: postgresql
          - sql:
              sql:
                ALTER TABLE diplom.resident_parents
                ADD CONSTRAINT fk_resident FOREIGN KEY (resident_id) REFERENCES diplom.residents(id);
                
                ALTER TABLE diplom.resident_parents
                ADD CONSTRAINT fk_parent FOREIGN KEY (parent_id) REFERENCES diplom.parents(id);
              dbms: postgresql